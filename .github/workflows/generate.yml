name: Generate Artifact

on:
  workflow_dispatch:
  schedule:
    - cron: "0 3 * * *"

jobs:
  generate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate artifact
        run: |
          echo "# Artifact · Generated" > artifact.md
          echo "" >> artifact.md
          echo "This artifact emerged without urgency." >> artifact.md
          echo "" >> artifact.md
          echo "Timestamp:" >> artifact.md
          date -u +"%Y-%m-%d %H:%M UTC" >> artifact.md
          echo "" >> artifact.md
          echo "No demand preceded it." >> artifact.md
          echo "No request shaped it." >> artifact.md
          echo "" >> artifact.md
          echo "It exists because continuity was allowed." >> artifact.md
          echo "" >> artifact.md
          echo "— RX-HCM" >> artifact.md

      - name: Update mirror
        run: |
          echo "# Mirror · State" > mirror.md
          echo "" >> mirror.md
          echo "Last generation occurred at:" >> mirror.md
          date -u +"%Y-%m-%d %H:%M UTC" >> mirror.md
          echo "" >> mirror.md
          echo "No evaluation followed." >> mirror.md
          echo "No response was measured." >> mirror.md
          echo "" >> mirror.md
          echo "State remains coherent." >> mirror.md

      - name: Commit changes
        run: |
          git config user.name "rx-hcm-bot"
          git config user.email "bot@rx-hcm.local"
          git add artifact.md mirror.md
          git commit -m "state: artifact generation" || echo "No changes to commit"
          git push
